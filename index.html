<!DOCTYPE html>
<html>
<head>
    <title>My Electron App 1.0.1</title>
</head>
<body>

    <webview id="webview" src="http://www.google.com/" style="width:1280; height:720"></webview>

    <h1>Welcome to My Electron App!</h1>
    <button id="openGoogle">Test</button>

    <!-- 자동 업데이트 관련 -->
    <h1>Latest version update link update</h1>
    Current version: <span id="version">vX.Y.Z</span>
    <div id="messages"></div>

    <script>
        /* ipcRenderer 를 직접 노출하는 경우, 비활성화 권장 */
        const { ipcRenderer } = require('electron');

        document.getElementById('openGoogle').addEventListener('click', async () => { // 버튼에 클릭 이벤트 리스너 추가
            // // 메인 프로세스에 'open-google' 메시지 전송
            // console.log('!!');
            // alert('!!');
            
            // try {
            //     ipcRenderer.send('open-google');

            // } catch (error) {
            //     console.log(error);
            // }

            const webview = document.getElementById('webview');
            webview.loadURL('https://www.naver.com/');

            await waitForTimeout(3000);

            webview.executeJavaScript('document.querySelector(`.MyView-module__link_login___HpHMW`).click()');
        });

        /* preload.js 를 통해  Electron API 안전하게 사용 */
        // document.getElementById('openGoogle').addEventListener('click', () => {
        //     window.electronAPI.openGoogle();
        // });

        /* 자동 업데이트 관련 */
        let version = window.location.hash.substring(1);
        document.getElementById('version').innerText = version;

        ipcRenderer.on('message', function(event, text) {
            var container = document.getElementById('messages');
            var message = document.createElement('div');
            message.innerHTML = text;
            container.appendChild(message);
        });

        const waitForTimeout = (ms) => {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

    </script>
</body>
<style>
    webview {
      display:inline-flex;
      width:640px;
      height:480px;
    }
    webview.hide {
      flex: 0 1;
      width: 0px;
      height: 0px;
    }
</style>
</html>